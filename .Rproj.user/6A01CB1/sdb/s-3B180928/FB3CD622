{
    "collab_server" : "",
    "contents" : "# Get matlab library and data files\nsource ('plot_PnET.R')\n\n# Get wood specific variables from output files\nwoodm0       <- as.numeric (unlist (data0$out   [35]))\nwoodm1       <- as.numeric (unlist (data1$out   [35]))\nwoodm2       <- as.numeric (unlist (data2$out   [35]))\nwoodm0.1     <- as.numeric (unlist (data0.1$out [35]))\nwoodm1.1     <- as.numeric (unlist (data1.1$out [35]))\nwoodm2.1     <- as.numeric (unlist (data2.1$out [35]))\n\n# Get growth in woody biomass\ndwoodm0   = woodm0   [2:297] - woodm0   [1:296]\ndwoodm1   = woodm1   [2:297] - woodm1   [1:296]\ndwoodm2   = woodm2   [2:297] - woodm2   [1:296]\ndwoodm0.1 = woodm0.1 [2:297] - woodm0.1 [1:296]\ndwoodm1.1 = woodm1.1 [2:297] - woodm1.1 [1:296]\ndwoodm2.1 = woodm2.1 [2:297] - woodm2.1 [1:296]\n\n# Plot monthly wood carbon for 1901-1996\npar (mfrow = c (3, 1))\nplot (x    = woodm0 [201:297],\n      typ  = 'l',\n      ylim = c (19000, 30000),\n      xaxt = 'n',\n      lty  = 1,\n      xlab = 'Year',\n      col  = 'darkgrey',\n      ylab = expression (paste ('Wood mass (g ',m^-2,' ',yr^-1,')')))\naxis (1, labels = c ('1900','1910','1920','1930','1940','1950','1960','1970','1980','1990','2000'), at = seq (0, 100, 10))\nlines (x   = woodm0.1 [201:297], \n       lty = 2,\n       col = 'darkgrey')\nlines (x   = woodm1   [201:297], \n       lty = 1,\n       col = 'purple')\nlines (x   = woodm1.1 [201:297], \n       lty = 2,\n       col = 'purple')\nlines (x   = woodm2   [201:297], \n       lty = 1,\n       col = 'darkgreen')\nlines (x   = woodm2.1 [201:297], \n       lty = 2,\n       col = 'darkgreen')\nlegend (x       = 1,\n        y       = 30000,\n        legend  = c ('NULL','ONE',\"TWO\"),\n        lty     = c (3, 2, 1),\n        col     = c ('black','purple','darkgreen'),\n        box.lty = 0,\n        bg      = 'transparent')\n\nplot (x    = dwoodm0 [201:297],\n      typ  = 'l',\n      ylim = c (-200, 250),\n      lty  = 1,\n      xaxt = 'n',\n      xlab = 'Year',\n      col  = 'darkgrey',\n      ylab = expression (paste ('Wood mass increment (g ',m^-2,' ',yr^-1,')')))\naxis (1, labels = c ('1900','1910','1920','1930','1940','1950','1960','1970','1980','1990','2000'), at = seq (0, 100, 10))\nlines (x = dwoodm0.1 [201:297], \n       lty = 2,\n       col = 'darkgrey')\nlines (x = dwoodm1   [201:297], \n       lty = 1,\n       col = 'purple')\nlines (x = dwoodm1.1 [201:297], \n       lty = 2,\n       col = 'purple')\nlines (x = dwoodm2   [201:297], \n       lty = 1,\n       col = 'darkgreen')\nlines (x = dwoodm2.1 [201:297], \n       lty = 2,\n       col = 'darkgreen')\nlegend (x       = 1,\n        y       = 250,\n        legend  = c ('NULL','ONE','TWO'),\n        lty     = c (3, 2, 1),\n        col     = c ('black','purple','darkgreen'),\n        box.lty = 0,\n        bg      = 'transparent')\n\n#plot (x    = woodcMo0, \n#      typ  = 'l', \n#      lty  = 1,\n#      xlab = 'Year',\n#      xaxt = 'n',\n#      col  = 'darkgrey',\n#      ylab = expression (paste ('Allocation of C to wood (gC ',m^-2,' ',yr^-1,')')),\n#      ylim = c (150, 390))\n#axis (1, labels = c ('1900','1910','1920','1930','1940','1950','1960','1970','1980','1990'), at = seq (0, 1152, 120))\n#lines (x   = woodcMo0.1, \n#       lty = 2,\n#       col = 'darkgrey')\n#lines (x   = woodcMo1, \n#       lty = 1,\n#       col = 'purple')\n#lines (x   = woodcMo1.1, \n#       lty = 2,\n#       col = 'purple')\n#lines (x   = woodcMo2, \n#       lty = 1,\n#       col = 'darkgreen')\n#lines (x   = woodcMo2.1, \n#       lty = 2,\n#       col = 'darkgreen')\n#legend (x       = 1,\n#        y       = 395,\n#        legend  = c ('NULL','ONE','TWO'),\n#        lty     = c (3, 2, 1),\n#        col     = c ('black','purple','darkgreen'),\n#        box.lty = 0,\n#        bg      = 'transparent')\n\n\n# Determine autocorrelation of wood mass increment\nfit0.ac   <- acf (dwoodm0)\nfit1.ac   <- acf (dwoodm1)\nfit2.ac   <- acf (dwoodm2)\nfit0.1.ac <- acf (dwoodm0.1)\nfit1.1.ac <- acf (dwoodm1.1)\nfit2.1.ac <- acf (dwoodm2.1)\npar (mfrow = c (1, 1))\nplot (x    = fit0.ac$acf,\n      typ  = 'l',\n      xlab = 'lag (years)',\n      ylab = 'autocorrelation coefficients',\n      lty  = 1,\n      col  = 'darkgrey')\nlines (x   = fit0.1.ac$acf,\n       lty = 2,\n       col = 'darkgrey')\nlines (x   = fit1.ac$acf,\n       lty = 1,\n       col = 'purple')\nlines (x   = fit1.1.ac$acf,\n       lty = 2,\n       col = 'purple')\nlines (x   = fit2.ac$acf,\n       lty = 1,\n       col = 'darkgreen')\nlines (x   = fit2.1.ac$acf,\n       lty = 2,\n       col = 'darkgreen')\nlegend (x       = 20, \n        y       = 1.0,\n        legend  = c ('NULL','ONE','TWO'),\n        col     = c ('black','purple','darkgreen'),\n        lty     = 1,\n        box.lty = 0,\n        bg = 'transparent')\n\n# Determine autocorrelation of nppwood\nfit0.ac   <- acf (as.numeric (unlist (data0$out   [17])))\nfit1.ac   <- acf (as.numeric (unlist (data1$out   [17])))\nfit2.ac   <- acf (as.numeric (unlist (data2$out   [17])))\nfit0.1.ac <- acf (as.numeric (unlist (data0.1$out [17])))\nfit1.1.ac <- acf (as.numeric (unlist (data1.1$out [17])))\nfit2.1.ac <- acf (as.numeric (unlist (data2.1$out [17])))\npar (mfrow = c (1, 1))\nplot (x    = fit0.ac$acf,\n      typ  = 'l',\n      xlab = 'lag (years)',\n      ylab = 'autocorrelation coefficients',\n      lty  = 1,\n      col  = 'darkgrey')\nlines (x   = fit0.1.ac$acf, \n       lty = 2, \n       col = 'darkgrey')\nlines (x   = fit1.ac$acf,\n       lty = 1,\n       col = 'purple')\nlines (x   = fit1.1.ac$acf, lty = 2, col = 'purple')\nlines (x   = fit2.ac$acf,\n       lty = 1,\n       col = 'darkgreen')\nlines (x   = fit2.1.ac$acf, lty = 2, col = 'darkgreen')\nlegend (20, 1.0,\n        legend = c ('NULL','ONE','TWO'),\n        col = c ('black','purple','darkgreen'),\n        lty = 1,\n        box.lty = 0,\n        bg = 'transparent')\n\n# Linear models without autocorrelation\nyears <- 1900:1996\ndat <- data.frame (cbind (years, woodm0 [201:297], woodm1 [201:297], woodm2 [201:297]))\nnames (dat) <- c ('years','woodm0','woodm1','woodm2')\nfit0 <- lm (woodm0 ~ years, data = dat)\nfit1 <- lm (woodm1 ~ years, data = dat)\nfit2 <- lm (woodm2 ~ years, data = dat)\nsummary (fit0)\nsummary (fit1)\nsummary (fit2)\n\npar (mfrow = c (2, 2))\nplot (fit0)\nplot (fit1)\nplot (fit2)\n\npar (mfrow = c (1, 1))\nplot (residuals (fit0), typ = 'b'); abline (h = 0)\nplot (residuals (fit1), typ = 'b'); abline (h = 0)\nplot (residuals (fit2), typ = 'b'); abline (h = 0)\n\npar (mfrow = c (3, 1))\nacf (residuals (fit0))\nacf (residuals (fit1))\nacf (residuals (fit2))\n\nlibrary ('nlme')\n\nfit0.ac <- gls (woodm0 ~ years, data = dat, correlation = corAR1 (form =~years), na.action = na.omit)\nsummary (fit0.ac)\n\n\n# 1996 plots\npar (mfrow = c (2, 1))\nplot (x    = netpsnMo1 [3553:3564], \n      typ  = 'l',\n      col  = 'darkgreen',\n      xaxt = 'n',\n      xlab = 'month',\n      ylab = 'Net carbon assimilation')\naxis (1, labels = months, at = 1:12)\nlines (folgrespMo1 [3554:3564])\nlines (woodgrespMo1 [3554:3564], lty = 2)\nlines (woodmrespMo1 [3554:3564], lty = 3)",
    "created" : 1492541580969.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "45874372",
    "id" : "FB3CD622",
    "lastKnownWriteTime" : 1493056615,
    "last_content_update" : 1493056788658,
    "path" : "~/Desktop/NSC modelling/PnET_M2.2/plot_PnET_wood_and_growth.R",
    "project_path" : "plot_PnET_wood_and_growth.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}