{
    "collab_server" : "",
    "contents" : "#==============================================================================#\n# Read the output data of PnET-CN to plot it\n#------------------------------------------------------------------------------#\n\n# load libraries\n#------------------------------------------------------------------------------#\nlibrary (R.matlab)\n\nmonths <- c ('jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec')\n\n# Read data files\ndata     <- readMat ('outputs/out.mat')\ndata_def <- readMat ('outputs/out_def.mat')\n\ndata0    <- readMat ('outputs/out_no_pool.mat')\ndata1    <- readMat ('outputs/out_one_pool.mat')\ndata1.2  <- readMat ('outputs/out_one_pool_no_water_stress.mat')\ndata2    <- readMat ('outputs/out_two_pool.mat')\ndata0.1  <- readMat ('outputs/out_no_pool_defoliation_event_0p75.mat')\ndata1.1  <- readMat ('outputs/out_one_pool_defoliation_event_0p75.mat')\ndata1.3  <- readMat ('outputs/out_one_pool_defoliation_event_0p75_no_water_stress.mat')\ndata2.1  <- readMat ('outputs/out_two_pool_defoliation_event_0p75.mat')\n\n# Get Carbon Cycle variables for no pool model\nplantcMo0 <- as.numeric (unlist (data0$out [ 7]))\nbudcMo0   <- as.numeric (unlist (data0$out [ 8]))\nwoodcMo0  <- as.numeric (unlist (data0$out [ 9]))\nrootcMo0  <- as.numeric (unlist (data0$out [10]))\n\n# Get Carbon Cycle variables for standard\nplantcMo1    <- as.numeric (unlist (data1$out [ 7]))\nbudcMo1      <- as.numeric (unlist (data1$out [ 8]))\nwoodcMo1     <- as.numeric (unlist (data1$out [ 9]))\nrootcMo1     <- as.numeric (unlist (data1$out [10]))\n\n# Get Carbon Cycle variables for fast slow pool model\nplantcMo2     <- as.numeric (unlist (data2$out [ 7]))\nplantcfastMo2 <- as.numeric (unlist (data2$out [ 8]))\nplantcslowMo2 <- as.numeric (unlist (data2$out [ 9]))\nbudcMo2       <- as.numeric (unlist (data2$out [10]))\nwoodcMo2      <- as.numeric (unlist (data2$out [11]))\nrootcMo2      <- as.numeric (unlist (data2$out [12]))\n\n\n# Bookkeeing to account for the NSC that is invested in wood and foliage formation\nplantNSC0 <- array (NA, dim = 3564); plantNSC1 <- array (NA, dim = 3564); plantNSC2 <- array (NA, dim = 3564)\nyear = 0\nfor (yr in 1:297){\n  year = year + 1\n  for (mon in 1:12) {\n    if (mon < 4) {\n      plantNSC0     [(year - 1) * 12 + mon] <- plantcMo0     [(year - 1) * 12 + mon] + woodcMo0 [(year - 1) * 12 + mon] + budcMo0 [(year - 1) * 12 + mon]\n      plantNSC1     [(year - 1) * 12 + mon] <- plantcMo1     [(year - 1) * 12 + mon] + woodcMo1 [(year - 1) * 12 + mon] + budcMo1 [(year - 1) * 12 + mon]\n      plantNSC2     [(year - 1) * 12 + mon] <- plantcMo2     [(year - 1) * 12 + mon] + woodcMo2 [(year - 1) * 12 + mon] + budcMo2 [(year - 1) * 12 + mon]\n      plantcfastMo2 [(year - 1) * 12 + mon] <- plantcfastMo2 [(year - 1) * 12 + mon] + woodcMo2 [(year - 1) * 12 + mon] + budcMo2 [(year - 1) * 12 + mon]\n    } else {\n      plantNSC0     [(year - 1) * 12 + mon] <- plantcMo0     [(year - 1) * 12 + mon]\n      plantNSC1     [(year - 1) * 12 + mon] <- plantcMo1     [(year - 1) * 12 + mon]\n      plantNSC2     [(year - 1) * 12 + mon] <- plantcMo2     [(year - 1) * 12 + mon]\n      plantcfastMo2 [(year - 1) * 12 + mon] <- plantcfastMo2 [(year - 1) * 12 + mon]\n    }\n  }\n}\n\n# Extract for 1901-1996 and sum for total NSC budget\nplantNSC0 <- plantNSC0 [2413:3564]; plantNSC1 <- plantNSC1 [2413:3564]; plantNSC2 <- plantNSC2 [2413:3564]\nplantcMo0 <- plantcMo0 [2413:3564]; plantcMo1 <- plantcMo1 [2413:3564]; plantcMo2 <- plantcMo2 [2413:3564]\nbudcMo0   <- budcMo0   [2413:3564]; budcMo1   <- budcMo1   [2413:3564]; budcMo2   <- budcMo2   [2413:3564] \nwoodcMo0  <- woodcMo0  [2413:3564]; woodcMo1  <- woodcMo1  [2413:3564]; woodcMo2  <- woodcMo2  [2413:3564]\nrootcMo0  <- rootcMo0  [2413:3564]; rootcMo1  <- rootcMo1  [2413:3564]; rootcMo2  <- rootcMo2  [2413:3564] \n\n# Get mean-period monthly values \naveplantc0    <- sapply (1:12, function (x) mean (plantcMo0     [seq (x,  length (plantcMo0), 12)]))\navebudc0      <- sapply (1:12, function (x) mean (budcMo0       [seq (x,  length (budcMo0),   12)]))\navewoodc0     <- sapply (1:12, function (x) mean (woodcMo0      [seq (x,  length (woodcMo0),  12)]))\naverootc0     <- sapply (1:12, function (x) mean (rootcMo0      [seq (x,  length (rootcMo0),  12)]))\navePlantNSC0  <- c (aveplantc0 [1:3] + avewoodc0 [1] + avebudc0 [1], aveplantc0 [4:12])\n\naveplantc1    <- sapply (1:12, function (x) mean (plantcMo1     [seq (x,  length (plantcMo1), 12)]))\navebudc1      <- sapply (1:12, function (x) mean (budcMo1       [seq (x,  length (budcMo1),   12)]))\navewoodc1     <- sapply (1:12, function (x) mean (woodcMo1      [seq (x,  length (woodcMo1),  12)]))\naverootc1     <- sapply (1:12, function (x) mean (rootcMo1      [seq (x,  length (rootcMo1),  12)]))\navePlantNSC1  <- c (aveplantc1 [1:3] + avewoodc1 [1] + avebudc1 [1], aveplantc1 [4:12])\n\navePlantCfast2 <- sapply (1:12, function (x) mean (plantcfastMo2 [seq (x,  length (plantNSC2), 12)]))\navePlantCslow2 <- sapply (1:12, function (x) mean (plantcslowMo2 [seq (x,  length (plantNSC2), 12)]))\naveplantc2     <- sapply (1:12, function (x) mean (plantcMo2     [seq (x,  length (plantcMo2), 12)]))\navebudc2       <- sapply (1:12, function (x) mean (budcMo2       [seq (x,  length (budcMo2),   12)]))\navewoodc2      <- sapply (1:12, function (x) mean (woodcMo2      [seq (x,  length (woodcMo2),  12)]))\naverootc2      <- sapply (1:12, function (x) mean (rootcMo2      [seq (x,  length (rootcMo2),  12)]))\navePlantNSC2   <- c (aveplantc2 [1:3] + avewoodc2 [1] + avebudc2 [1], aveplantc2    [4:12]) # Should it just be the fast plant carbon?\n\n# Plot standard representation\npar (mar = c (5, 5, 1, 1))\npar (mfrow = c (3, 1))\nplot (x    = avePlantNSC0, \n      typ  = 'l',\n      xlab = 'month',\n      ylab = expression (paste ('NSCs (gC ',m^-2,')')),\n      ylim = c (0, 2700),\n      xlim = c (1, 12),\n      xaxt = 'n',\n      lwd  = 2,\n      col  = 'white')\nannual_lines <- sapply (1:96, function (x) lines (plantNSC0 [(x - 1) * 12 + 1:(x * 12)], lwd = 0.1, col = 'darkgrey'))\naxis (1, labels = months, at = 1:12)\nlegend (1, 2700, c ('mean','annual'), box.lty = 0, col = c ('darkgrey','darkgrey'), lwd = c (2, 0.1))\nrect (xleft   = 12, \n      ybottom = 0,\n      xright  = 13,\n      ytop    = 2000,\n      col     = 'white',\n      lty     = 0)\nlines (avePlantNSC0,  col = 'darkgrey', lwd = 2)\nbox ()\ntext (12.2, 2500, 'NULL')\n\nplot (x    = avePlantNSC1, \n      typ  = 'l',\n      xlab = 'month',\n      ylab = expression (paste ('NSCs (gC ',m^-2,')')),\n      ylim = c (0, 2700),\n      xlim = c (1, 12),\n      xaxt = 'n',\n      lwd  = 2,\n      col  = 'white')\nannual_lines <- sapply (1:96, function (x) lines (plantNSC1 [(x - 1) * 12 + 1:(x * 12)], lwd = 0.1, col = 'darkgrey'))\naxis (1, labels = months, at = 1:12)\nlegend (1, 2700, c ('mean','annual'), box.lty = 0, col = c ('darkgrey','darkgrey'), lwd = c (2, 0.1))\nrect (xleft   = 12, \n      ybottom = 0,\n      xright  = 13,\n      ytop    = 2000,\n      col     = 'white',\n      lty     = 0)\nlines (avePlantNSC1,  col = 'darkgrey', lwd = 2)\nbox ()\ntext (12.2, 2500, 'ONE')\n\n#\nplot (x    = avePlantNSC2, \n      typ  = 'l', \n      lwd  = 1, \n      ylim = c (0, 2700), \n      col  = 'white', \n      ylab = expression (paste ('NSCs (gC ',m^-2,')')),\n      xlab = 'month',\n      xlim = c (1, 12),\n      xaxt = 'n')\naxis (1, labels = months, at = 1:12)\nannual_lines <- sapply (1:96, function (x) lines (plantNSC2     [(x - 1) * 12 + 1:(x * 12)], lwd = 0.1, col = 'darkgrey'))\nannual_lines <- sapply (1:96, function (x) lines (plantcfastMo2 [(x - 1) * 12 + 1:(x * 12)], lwd = 0.1, col = 'darkred'))\nannual_lines <- sapply (1:96, function (x) lines (plantcslowMo2 [(x - 1) * 12 + 1:(x * 12)], lwd = 0.1, col = 'darkblue'))\nlegend (1, 2700, c ('total','fast','slow'), box.lty = 0, col = c ('darkgrey','darkred','darkblue'), lwd = 2,\n        bg = 'transparent')\nrect (xleft   = 12, \n      ybottom = 0,\n      xright  = 13,\n      ytop    = 4000,\n      col     = 'white',\n      lty     = 0)\nlines (avePlantNSC2,   col = 'darkgrey', lwd = 2)\nlines (avePlantCslow2, col = 'darkblue', lwd = 2)\nlines (avePlantCfast2, col = 'darkred',  lwd = 2)\nbox ()\ntext (12.2, 2500, 'TWO')\n#==============================================================================#",
    "created" : 1492450883664.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3394956239",
    "id" : "4C08E8D1",
    "lastKnownWriteTime" : 1493040227,
    "last_content_update" : 1493062888507,
    "path" : "~/Desktop/NSC modelling/PnET_M2.2/plot_PnET.R",
    "project_path" : "plot_PnET.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}